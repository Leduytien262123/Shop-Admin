import{c as h,K as A}from"./index-DYcU_f0W.js";const C={view:"Xem",edit:"Chỉnh sửa",add:"Thêm mới"};function y(v={}){const{name:l="",initForm:s={},doCreate:u,doUpdate:r,doDelete:g,refresh:f}=v,o=h(""),c=h(null),d=h(null),a=A({...s});function O(n={}){var e;o.value="add",Object.assign(a,s,n),(e=c.value)==null||e.handleOpen({title:`Thêm ${l}`,okText:"Thêm mới"})}function T(n={}){var e;o.value="edit",Object.assign(a,s,n),(e=c.value)==null||e.handleOpen({title:`Chỉnh sửa ${l}`,okText:"Lưu"})}function p(n={}){var e;o.value="view",Object.assign(a,s,n),(e=c.value)==null||e.handleOpen({title:`Xem ${l}`})}function b(n={}){var m;const{action:e,title:i,row:t,onOk:x,...X}=n;o.value=e,Object.assign(a,s,t),(m=c.value)==null||m.handleOpen({title:i||`${C[e]}${l}`,onOk:x||$,...X})}async function $(){var t;await((t=d.value)==null?void 0:t.validate());const{api:n,cb:e,...i}=w();return handleSave({api:n,cb:e,...i})}function w(){return o.value==="add"?{api:()=>u==null?void 0:u(a),cb:()=>$message.success("Thêm mới thành công")}:{api:()=>r==null?void 0:r(a),cb:()=>$message.success("Lưu thành công")}}function k(n,e){if(!n&&n!==0)return;const i=$dialog.warning({content:"Xác nhận xóa?",title:"Thông báo",positiveText:"Xác nhận",negativeText:"Hủy",async onPositiveClick(){try{i.loading=!0;const t=await g(n);$message.success("Xóa thành công"),i.loading=!1,f(t,!0)}catch(t){console.error(t),i.loading=!1}},...e})}return{modalRef:c,modalFormRef:d,modalAction:o,modalForm:a,handleAdd:O,handleDelete:k,handleEdit:T,handleView:p,handleOpen:b}}export{y as u};
