import{_ as L}from"./CommonPage-r69Mp4tc.js";import{c as o,af as R,d as V,o as I,e as s,Z as v,u as O,j as a,ah as P,W as Q,l as m,aj as U,a8 as A,a9 as E,g as p,E as i,h as C,ak as S,al as W,p as c,am as Z,an as q,O as F}from"./index-DYcU_f0W.js";import{_ as G}from"./ModalDetail-DGX9te_j.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TheFooter-BtZThfEk.js";import"./AppCard-kEEXouea.js";const ee={class:"flex justify-end gap-12"},te={class:"flex gap-12 mb-8 items-end"},ae=Object.assign({name:"CategoryManagement"},{__name:"index",setup(ne){const k=O(),x=o([]),u=o(!1),r=o(""),w=o(null),f=o(!1),T=o("Chi tiết danh mục"),g=o(null),$=[{title:"Tên",key:"name",ellipsis:!0},{title:"Mô tả",key:"description",ellipsis:!0},{title:"Trạng thái",key:"is_active",render(t){return c(Z,{type:t.is_active?"success":"",size:"small"},{default:()=>t.is_active?"Hoạt động":"Dừng hoạt động"})}},{title:"Ngày tạo",key:"created_at",render(t){return q(t.created_at).format("DD/MM/YYYY")}},{title:"Hành động",key:"actions",render(t){return c("div",{class:"flex gap-2"},[c(i,{size:"small",onClick:()=>D(t.id)},{default:()=>"Xem"}),c(i,{size:"small",type:"primary",onClick:()=>M(t.id)},{default:()=>"Sửa"}),c(i,{size:"small",type:"error",onClick:()=>B(t.id)},{default:()=>"Xóa"})])}}];function b(t,e){let n=0;return function(...l){const d=Date.now();if(d-n>=e)return n=d,t.apply(this,l)}}async function h(){var t;try{u.value=!0;const e={page:1,length:10};r.value&&(e.search=r.value);const n=await v.getCategories(e);x.value=((t=n.data)==null?void 0:t.data)||[]}catch{$message.error("Không thể tải danh sách danh mục")}finally{u.value=!1}}const y=b(h,500);async function D(t){var e,n;f.value=!0,await F(),(e=g.value)!=null&&e.focus&&g.value.focus();try{const l=await v.getCategoryById(t);w.value=((n=l.data)==null?void 0:n.data)||null}catch{$message.error("Không thể tải chi tiết danh mục")}}function M(t){k.push(`/category/edit/${t}`)}function B(t){$dialog.warning({title:"Xác nhận xóa",content:"Bạn có chắc chắn muốn xóa danh mục này?",positiveText:"Xóa",negativeText:"Hủy",onPositiveClick:async()=>{try{await v.deleteCategory(t),$message.success("Đã xóa danh mục thành công"),h()}catch(e){console.error("Lỗi khi xóa danh mục:",e),$message.error("Không thể xóa danh mục")}}})}function K(){k.push("/category/add")}function N(){r.value=null,y()}function j(){y()}return R(()=>{h()}),(t,e)=>{const n=A,l=U,d=W,z=S,X=Q,Y=P,H=L;return I(),V(H,null,{action:s(()=>[m("div",ee,[a(p(i),{type:"info",onClick:N},{default:s(()=>e[3]||(e[3]=[m("i",{class:"i-material-symbols:refresh mr-4 text-18"},null,-1),C(" Tải lại danh sách ")])),_:1,__:[3]}),a(p(i),{type:"primary",onClick:e[0]||(e[0]=_=>K())},{default:s(()=>e[4]||(e[4]=[m("i",{class:"i-material-symbols:add mr-4 text-18"},null,-1),C(" Tạo danh mục ")])),_:1,__:[4]})])]),default:s(()=>[a(Y,{title:"Quản lý danh mục"},{default:s(()=>[a(X,{vertical:""},{default:s(()=>[m("div",te,[a(l,{label:"Tìm kiếm danh mục",class:"w-full"},{default:s(()=>[a(n,{clearable:"",placeholder:"Nhập tìm kiếm ...",value:r.value,"onUpdate:value":e[1]||(e[1]=_=>r.value=_),onKeyup:E(p(y),["enter"])},null,8,["value","onKeyup"])]),_:1}),a(p(i),{type:"primary",onClick:j},{default:s(()=>e[5]||(e[5]=[C("Tìm kiếm")])),_:1,__:[5]})]),a(z,{show:u.value},{default:s(()=>[a(d,{columns:$,data:x.value,bordered:!0,striped:!0,loading:u.value},null,8,["data","loading"])]),_:1},8,["show"])]),_:1})]),_:1}),a(G,{ref_key:"detailModalRef",ref:g,show:f.value,"onUpdate:show":e[2]||(e[2]=_=>f.value=_),data:w.value,title:T.value},null,8,["show","data","title"])]),_:1})}}}),ue=J(ae,[["__scopeId","data-v-58fdc7e0"]]);export{ue as default};
