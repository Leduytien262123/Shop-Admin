import{_ as O}from"./CommonPage-r69Mp4tc.js";import{c as m,w as V,d as T,o as _,e as s,l as r,j as l,ak as E,g as t,G as M,f as x,F as R,t as o,E as h,h as i,aU as U,aV as D,n as P,p,aW as X,ap as j,O as A}from"./index-DYcU_f0W.js";import{_ as I}from"./index-DzJzXdOC.js";import{a as g,_ as q}from"./ResAddOrEdit-Du7kSZir.js";import F from"./MenuTree-BVBtIG6t.js";import"./TheFooter-BtZThfEk.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppCard-kEEXouea.js";import"./_isme_icons-VdKe73uL.js";import"./useForm-b0yQVc1X.js";import"./QuestionLabel-BpZlfaih.js";const G={class:"flex"},H={class:"ml-40 w-0 flex-1"},W={class:"flex justify-between"},J={class:"mb-12"},Q={key:0,class:"flex items-center"},Y={class:"opacity-50"},Z={key:1},ee={class:"mt-32 flex justify-between"},_e={__name:"index",setup(ne){const y=m([]),b=m(!1),u=m(null),a=m(null);async function k(e){if((e==null?void 0:e.type)==="BUTTON"){u.value.handleSearch();return}b.value=!0;const n=await g.getMenuTree();y.value=(n==null?void 0:n.data)||[],b.value=!1,e&&(a.value=e)}k();const f=m(null);function w(e={}){var n;(n=f.value)==null||n.handleOpen({action:"edit",title:`Sửa menu - ${e.name}`,row:e,okText:"Lưu"})}const C=[{title:"Tên",key:"name"},{title:"Mã",key:"code"},{title:"Trạng thái",key:"enable",render:e=>p(j,{size:"small",rubberBand:!1,value:e.enable,loading:!!e.enableLoading,onUpdateValue:()=>z(e)},{checked:()=>"Kích hoạt",unchecked:()=>"Tắt"})},{title:"Thao tác",key:"actions",width:320,align:"right",fixed:"right",render(e){return[p(h,{size:"small",type:"primary",style:"margin-left: 12px;",onClick:()=>B(e)},{default:()=>"Sửa",icon:()=>p("i",{class:"i-material-symbols:edit-outline text-14"})}),p(h,{size:"small",type:"error",style:"margin-left: 12px;",onClick:()=>S(e.id)},{default:()=>"Xóa",icon:()=>p("i",{class:"i-material-symbols:delete-outline text-14"})})]}}];V(()=>a.value,async e=>{await A(),e&&u.value.handleSearch()});function $(){var e;(e=f.value)==null||e.handleOpen({action:"add",title:"Thêm nút bấm",row:{type:"BUTTON",parentId:a.value.id},okText:"Lưu"})}function B(e){var n;(n=f.value)==null||n.handleOpen({action:"edit",title:`Sửa nút bấm - ${e.name}`,row:e,okText:"Lưu"})}function S(e){const n=$dialog.warning({content:"Xác nhận xóa?",title:"Thông báo",positiveText:"Xác nhận",negativeText:"Hủy",async onPositiveClick(){try{n.loading=!0,await g.deletePermission(e),$message.success("Xóa thành công"),u.value.handleSearch(),n.loading=!1}catch(d){console.error(d),n.loading=!1}}})}async function z(e){var n;try{e.enableLoading=!0,await g.savePermission(e.id,{enable:!e.enable}),$message.success("Thao tác thành công"),(n=u.value)==null||n.handleSearch(),e.enableLoading=!1}catch(d){console.error(d),e.enableLoading=!1}}return(e,n)=>{const d=E,c=D,L=U,N=X,K=O;return _(),T(K,null,{default:s(()=>[r("div",G,[l(d,{size:"small",show:t(b)},{default:s(()=>[l(F,{"current-menu":t(a),"onUpdate:currentMenu":n[0]||(n[0]=v=>M(a)?a.value=v:null),class:"w-320 shrink-0","tree-data":t(y),onRefresh:k},null,8,["current-menu","tree-data"])]),_:1},8,["show"]),r("div",H,[t(a)?(_(),x(R,{key:0},[r("div",W,[r("h3",J,o(t(a).name),1),l(t(h),{size:"small",type:"primary",onClick:n[1]||(n[1]=v=>w(t(a)))},{default:s(()=>n[2]||(n[2]=[r("i",{class:"i-material-symbols:edit-outline mr-4 text-14"},null,-1),i(" Sửa ")])),_:1,__:[2]})]),l(L,{"label-placement":"left",bordered:"",column:2},{default:s(()=>[l(c,{label:"Mã"},{default:s(()=>[i(o(t(a).code),1)]),_:1}),l(c,{label:"Tên"},{default:s(()=>[i(o(t(a).name),1)]),_:1}),l(c,{label:"Địa chỉ route"},{default:s(()=>[i(o(t(a).path??"--"),1)]),_:1}),l(c,{label:"Đường dẫn component"},{default:s(()=>[i(o(t(a).component??"--"),1)]),_:1}),l(c,{label:"Icon menu"},{default:s(()=>[t(a).icon?(_(),x("span",Q,[r("i",{class:P(`${t(a).icon}?mask text-22 mr-8`)},null,2),r("span",Y,o(t(a).icon),1)])):(_(),x("span",Z,"Không có"))]),_:1}),l(c,{label:"layout"},{default:s(()=>[i(o(t(a).layout||"Theo hệ thống"),1)]),_:1}),l(c,{label:"Có hiển thị"},{default:s(()=>[i(o(t(a).show?"Có":"Không"),1)]),_:1}),l(c,{label:"Có kích hoạt"},{default:s(()=>[i(o(t(a).enable?"Có":"Không"),1)]),_:1}),l(c,{label:"KeepAlive"},{default:s(()=>[i(o(t(a).keepAlive?"Có":"Không"),1)]),_:1}),l(c,{label:"Sắp xếp"},{default:s(()=>[i(o(t(a).order??"--"),1)]),_:1})]),_:1}),r("div",ee,[n[4]||(n[4]=r("h3",{class:"mb-12"}," Nút bấm ",-1)),l(t(h),{size:"small",type:"primary",onClick:$},{default:s(()=>n[3]||(n[3]=[r("i",{class:"i-fe:plus mr-4 text-14"},null,-1),i(" Thêm mới ")])),_:1,__:[3]})]),l(t(I),{ref_key:"$table",ref:u,columns:C,"scroll-x":-1,"get-data":t(g).getButtons,"query-items":{parentId:t(a).id}},null,8,["get-data","query-items"])],64)):(_(),T(N,{key:1,class:"h-450 f-c-c",size:"large",description:"Vui lòng chọn menu bên trái"}))])]),l(q,{ref_key:"modalRef",ref:f,menus:t(y),onRefresh:k},null,8,["menus"])]),_:1})}}};export{_e as default};
