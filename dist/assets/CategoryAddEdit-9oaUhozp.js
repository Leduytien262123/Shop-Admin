import{_ as j}from"./CommonPage-r69Mp4tc.js";import{u as L,c as h,J as q,w as z,af as A,d as D,o as I,e as l,j as n,ak as V,g as a,ao as F,aj as K,a8 as J,l as p,ap as O,aa as P,h as u,aq as Q,ar as W,as as Z,W as G,E as X,t as Y,ah as ee,Z as v}from"./index-DYcU_f0W.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-10"},ne={style:{display:"flex","align-items":"center",gap:"8px","margin-bottom":"8px"}},oe={class:"flex items-center justify-center"},le=Object.assign({name:"CategoriesAddEdit"},{__name:"CategoryAddEdit",props:{id:{type:[String,Number],default:null}},setup(y){const c=y,w=L(),b=h(null),d=h(!1),_=q(()=>!!c.id),t=h({name:"",description:"",slug:"",is_active:!0,show_menu:!1,show_home:!1,show_footer:!1,meta_title:"",meta_keywords:"",meta_description:"",meta_image:[]}),k={name:[{required:!0,message:"Tên danh mục không được để trống",trigger:["blur","input"]}],slug:[{required:!0,message:"Đường dẫn không được để trống",trigger:["blur","input"]}]};function C(o){return o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-")}z(()=>t.value.name,o=>{o&&(t.value.slug=C(o))});async function x(){if(c.id)try{d.value=!0;const o=await v.getCategoryById(c.id);o.data.success&&(t.value={name:o.data.data.name||"",description:o.data.data.description||"",slug:o.data.data.slug||"",is_active:o.data.data.is_active,show_menu:o.data.data.show_menu,show_home:o.data.data.show_home,show_footer:o.data.data.show_footer,meta_title:o.data.data.meta_title||"",meta_keywords:o.data.data.meta_keywords||"",meta_description:o.data.data.meta_description||"",meta_image:o.data.data.meta_image||[]})}catch(o){$message.error("Không thể tải thông tin danh mục"),console.error("Load category error:",o)}finally{d.value=!1}}function g(){w.push("/category")}async function N(){var o;try{await((o=b.value)==null?void 0:o.validate()),d.value=!0,_.value?(await v.updateCategory(c.id,t.value),$message.success("Cập nhật danh mục thành công!")):(await v.createCategory(t.value),$message.success("Thêm danh mục thành công!")),g()}catch(e){if(e!=null&&e.errors)return;const m=_.value?"Cập nhật danh mục thất bại":"Thêm danh mục thất bại";$message.error(m),console.error("Save category error:",e)}finally{d.value=!1}}return A(()=>{_.value&&x()}),(o,e)=>{const m=X,r=J,i=K,U=O,f=P,T=Z,M=W,B=Q,S=F,$=V,E=G,H=ee,R=j;return I(),D(R,null,{action:l(()=>[n(m,{onClick:g},{default:l(()=>e[11]||(e[11]=[p("i",{class:"i-material-symbols:arrow-back mr-4 text-18"},null,-1),u(" Quay lại ")])),_:1,__:[11]})]),default:l(()=>[n(H,{title:a(_)?"Sửa danh mục":"Thêm danh mục"},{action:l(()=>[p("div",oe,[n(E,null,{default:l(()=>[n(m,{onClick:g,disabled:a(d)},{default:l(()=>e[16]||(e[16]=[u(" Hủy ")])),_:1,__:[16]},8,["disabled"]),n(m,{type:"primary",onClick:N,loading:a(d)},{default:l(()=>[u(Y(a(_)?"Cập nhật":"Lưu"),1)]),_:1},8,["loading"])]),_:1})])]),default:l(()=>[n($,{show:a(d)},{default:l(()=>[n(S,{ref_key:"formRef",ref:b,model:a(t),rules:k,"label-placement":"top"},{default:l(()=>[n(i,{label:"Tên danh mục",path:"name"},{default:l(()=>[n(r,{value:a(t).name,"onUpdate:value":e[0]||(e[0]=s=>a(t).name=s),placeholder:"Nhập tên danh mục",disabled:a(d)},null,8,["value","disabled"])]),_:1}),n(i,{label:"Đường dẫn",path:"slug"},{default:l(()=>[n(r,{value:a(t).slug,"onUpdate:value":e[1]||(e[1]=s=>a(t).slug=s),placeholder:"Nhập đường dẫn",disabled:a(d)},null,8,["value","disabled"])]),_:1}),n(i,{label:"Mô tả"},{default:l(()=>[n(r,{value:a(t).description,"onUpdate:value":e[2]||(e[2]=s=>a(t).description=s),type:"textarea",placeholder:"Nhập mô tả danh mục",autosize:{minRows:3,maxRows:6},disabled:a(d)},null,8,["value","disabled"])]),_:1}),n(i,{label:"Trạng thái"},{default:l(()=>[p("div",te,[p("div",ne,[n(U,{value:a(t).is_active,"onUpdate:value":e[3]||(e[3]=s=>a(t).is_active=s),disabled:a(d)},null,8,["value","disabled"]),e[12]||(e[12]=p("span",null,"Hoạt động",-1))]),n(f,{checked:a(t).show_menu,"onUpdate:checked":e[4]||(e[4]=s=>a(t).show_menu=s),disabled:a(d)},{default:l(()=>e[13]||(e[13]=[u(" Hiển thị trên menu ")])),_:1,__:[13]},8,["checked","disabled"]),n(f,{checked:a(t).show_footer,"onUpdate:checked":e[5]||(e[5]=s=>a(t).show_footer=s),disabled:a(d)},{default:l(()=>e[14]||(e[14]=[u(" Hiển thị trên footer ")])),_:1,__:[14]},8,["checked","disabled"]),n(f,{checked:a(t).show_home,"onUpdate:checked":e[6]||(e[6]=s=>a(t).show_home=s),disabled:a(d)},{default:l(()=>e[15]||(e[15]=[u(" Hiển thị trên trang chủ ")])),_:1,__:[15]},8,["checked","disabled"])])]),_:1}),n(B,{accordion:"",class:"custom-collapse-light-blue grow rd-5 my-15","arrow-placement":"right"},{default:l(()=>[n(M,{class:"custom-collapse-header-light-blue",title:"Thông tin Meta",name:"meta"},{default:l(()=>[n(i,{label:"Meta Title"},{default:l(()=>[n(r,{value:a(t).meta_title,"onUpdate:value":e[7]||(e[7]=s=>a(t).meta_title=s),placeholder:"Nhập meta title"},null,8,["value"])]),_:1}),n(i,{label:"Meta Keywords"},{default:l(()=>[n(r,{value:a(t).meta_keywords,"onUpdate:value":e[8]||(e[8]=s=>a(t).meta_keywords=s),placeholder:"Nhập meta keywords"},null,8,["value"])]),_:1}),n(i,{label:"Meta Description"},{default:l(()=>[n(r,{value:a(t).meta_description,"onUpdate:value":e[9]||(e[9]=s=>a(t).meta_description=s),type:"textarea",placeholder:"Nhập meta description"},null,8,["value"])]),_:1}),n(i,{label:"Meta Image"},{default:l(()=>[n(T,{"file-list":a(t).meta_image,"onUpdate:fileList":e[10]||(e[10]=s=>a(t).meta_image=s),max:1,"list-type":"image-card",disabled:a(d)},null,8,["file-list","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1},8,["title"])]),_:1})}}}),re=ae(le,[["__scopeId","data-v-0b239f47"]]);export{re as C};
